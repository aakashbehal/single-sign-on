"use strict";(self.webpackChunkequabli_front_end=self.webpackChunkequabli_front_end||[]).push([[192],{8192:function(e,t,n){n.d(t,{Z:function(){return F}});var a=n(2982),i=n(4165),l=n(5861),r=n(885),s=n(2791),o=n(129),c=n(7022),u=n(2677),d=n(2105),p=n(2576),m=n(3360),f=n(9126),b=n(5880),h=n(6856),x=n(978),y=n(6053),g=n(6030),v=n(2092),j=n(4802),Z=n(2858),q=n.n(Z),w=n(1679),N=n(8803),k=n(7665),S=function(e){var t=(0,s.useState)(null),a=(0,r.Z)(t,2),o=a[0],c=a[1],u=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){var a,l,r,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,1===t.length)c({zipFile:a,file:t[0]});else{for(l=n(5587)(),r=null,s=0;s<t.length;s++)"matrix.xlsx"===t[s].name&&(r=t[s]),"application/zip"!==t[s].type&&"application/x-zip-compressed"!==t[s].type||(a=t[s]),a||"matrix.xlsx"===t[s].name||l.file(t[s].name,t[s]);a?c({matrixFile:r,file:a}):l.generateAsync({type:"blob"}).then((function(e){return new File([e],"new.zip",{type:"application/x-zip-compressed"})})).then((function(e){c({matrixFile:r,file:e})}))}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return[o,{zipTargetFiles:u}]},_=n(6196),D=n(2453),C=n(184),z=[{sheet:"Matrix",columns:[{label:"Document Type"},{label:"Product Code"},{label:"Original Account Number"},{label:"Client Account Number"},{label:"Document Generation Date"},{label:"Equabli Account Number"},{label:"Client Short Code"},{label:"File Name"}],content:[]}],F=function(e){var t=e.show,n=e.onHide,Z=(e.accountId,e.Styles),F=e.parentComponent,T=e.search,A=e.details,R=void 0===A?null:A,P=(0,v.e1)().addToast,I=(0,g.I0)(),E=(0,s.useRef)(),L=S(null),U=(0,r.Z)(L,2),O=U[0],M=U[1].zipTargetFiles,B=s.useState(!1),H=(0,r.Z)(B,2),W=H[0],G=H[1],J=s.useRef(null),K=(0,s.useState)([]),V=(0,r.Z)(K,2),Y=V[0],$=V[1],Q=(0,s.useState)(!1),X=(0,r.Z)(Q,2),ee=X[0],te=X[1],ne=(0,s.useState)({fileLengthSingle:!1,fileSize:!1}),ae=(0,r.Z)(ne,2),ie=ae[0],le=ae[1],re=(0,s.useState)(""),se=(0,r.Z)(re,2),oe=(se[0],se[1]),ce=(0,s.useState)(),ue=(0,r.Z)(ce,2),de=ue[0],pe=ue[1],me=(0,s.useState)(!1),fe=(0,r.Z)(me,2),be=fe[0],he=fe[1],xe=(0,s.useState)([]),ye=(0,r.Z)(xe,2),ge=ye[0],ve=ye[1],je=(0,s.useState)(null),Ze=(0,r.Z)(je,2),qe=Ze[0],we=Ze[1],Ne=(0,g.v9)((function(e){return{documentTypes:e.types.documentType.data}})).documentTypes;(0,s.useEffect)((function(){var e=D.W4.getUserType();oe(e),"documentNotSummary_request"===F&&Se()}),[]),(0,s.useEffect)((function(){O&&"{}"!==JSON.stringify(O)&&Ce()}),[O]);var ke=function(e,t){var n={fileName:e};q()(t,n)},Se=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,n,a,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.rF.post("".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("document-service/api","/user/document/summary/accounts/not"),{pageSize:R.pageSize,pageNumber:R.pageNumber-1,docTypeCode:R.docTypeCode,tenure:"null"===R.duration?null:R.duration,portfolio:"null"===R.portfolio?null:R.portfolio,productCode:"null"===R.productCode?null:R.productCode,userId:"null"===R.userId?null:R.userId});case 3:t=e.sent,n=(0,N._y)(t),a=[{sheet:"Matrix",columns:[{label:"Document Type",value:"documentType"},{label:"Requested From",value:"requestedFrom"},{label:"Original Account Number",value:"originalAccountNumber"},{label:"Client Account Number",value:"clientAccountNumber"},{label:"Equabli Account Number",value:"equabliAccountNumber"},{label:"Client Short Code",value:"clientShortCode"}],content:[]}],l=n&&n.response&&n.response.datas.map((function(e){return{documentType:R.docTypeCode,requestedFrom:"",originalAccountNumber:"",clientAccountNumber:e,equabliAccountNumber:"",clientShortCode:""}})),a[0].content=l,ve(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),_e=function(e){var t=!0,n={file:!1};for(var a in 0===e.file&&(n.fileLengthSingle=!0),e)e[a]&&""!==e[a]||(n[a]=!0);for(var i in n)n[i]&&(t=!1);return le(n),t},De=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),_e({file:Y.length})&&(te(!0),M(Y));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,a,l,r,s,o,c,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(he(!1),t={headers:{"Content-Type":"multipart/form-data"}},a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload"),l=O.file,r=O.matrixFile,"myDocument"!==F&&"receiveDocumentRequest"!==F||!(Y.length>1)||r){e.next=8;break}return te(!1),he(!0),e.abrupt("return");case 8:if(s=new FormData,e.prev=9,!(l.size>10485760)){e.next=14;break}return P((0,w.t)("info","FILE_LARGE",""),{appearance:"info",autoDismiss:!0}),te(!1),e.abrupt("return");case 14:if("application/zip"!==l.type&&"application/x-zip-compressed"!==l.type){e.next=27;break}return s.append("doc",l),s.append("doc",r),a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/bulk"),e.next=20,N.rF.post(a,s,t);case 20:o=e.sent,(0,N._y)(o),P((0,w.t)("success","uploaded","File"),{appearance:"success",autoDismiss:!0}),te(!1),n(),e.next=35;break;case 27:return"profile"===F?(a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("user-service/api","/v1/users/uploadProfilePic"),s.append("file",l)):"documents"===F?(c=E.current.document_type,a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/account"),s.append("accountNumber",R.accountId),s.append("docType",c.value),s.append("doc",l)):"receiveDocumentRequest"===F&&null!==R?(a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/fullfill"),s.append("doc",l),s.append("id",R.id)):"sentDocumentRequest"===F||"documentNotSummary_request"===F?(a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/bulk"),s.append("doc",l)):"documentNotSummary"===F?(a="".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/specific/accounts"),s.append("doc",l),s.append("docTypeCode",R.docTypeCode)):s.append("doc",l),e.next=30,N.rF.post(a,s,t);case 30:u=e.sent,(0,N._y)(u),P((0,w.t)("success","uploaded","File"),{appearance:"success",autoDismiss:!0}),te(!1),n();case 35:I(k.N.getSentSummary({})),T(),e.next=43;break;case 39:e.prev=39,e.t0=e.catch(9),te(!1),P((0,w.t)("error","uploading","file"),{appearance:"error",autoDismiss:!1});case 43:case"end":return e.stop()}}),e,null,[[9,39]])})));return function(){return e.apply(this,arguments)}}(),ze=function(e){e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?G(!0):"dragleave"===e.type&&G(!1)},Fe=function(e){var t=Object.assign([],Y);if("profile"===F){var n=new FileReader;n.readAsDataURL(e[0]);n.onloadend=function(e){pe(n.result)}}if("documents"!==F)t=0===t.length?Array.from(e):[].concat((0,a.Z)(t),(0,a.Z)(Array.from(e)));else{var i=Ne.map((function(e){return e.shortCode})),l=Array.from(e);i.map((function(e){l[0].name.includes("_".concat(e,"_"))&&we(e)})),t=Array.from(e)}$(t)},Te=function(e){e.preventDefault(),e.target.files&&e.target.files[0]&&Fe(e.target.files)},Ae=function(){"profile"!==F?J.current.click():Re.current.click()},Re=(0,s.useRef)();return(0,C.jsxs)(o.Z,{show:t,onHide:n,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,size:"lg",animation:!0,children:[(0,C.jsx)(o.Z.Header,{closeButton:!0,children:(0,C.jsxs)(o.Z.Title,{id:"contained-modal-title-vcenter",children:["myDocument"===F||"documents"===F||"documentNotSummary"===F||"documentNotSummary_request"===F?"Upload New Document":"sentDocumentRequest"===F?"Upload file for bulk document request":"","profile"===F&&"Upload Profile Picture","receiveDocumentRequest"===F&&"Upload File to FulFill the request"]})}),(0,C.jsx)(o.Z.Body,{className:"show-grid",children:(0,C.jsx)(c.Z,{children:(0,C.jsxs)(u.Z,{sm:12,children:["profile"!==F&&(0,C.jsx)("div",{className:Z.list_upload_container,children:Y&&Y.length>0&&Y.map((function(e,t){return(0,C.jsx)("div",{className:Z.list_upload,children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,C.jsx)(u.Z,{sm:6,children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["application/x-zip-compressed"===e.type&&(0,C.jsx)(y.nzh,{}),"application/pdf"===e.type&&(0,C.jsx)(f.DWq,{}),("image/png"===e.type||"image/jpeg"===e.type)&&(0,C.jsx)(f.tf6,{}),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type&&(0,C.jsx)(x.bBH,{}),(0,C.jsx)(d.Z,{placement:"bottom",delay:{show:250,hide:400},overlay:(0,C.jsx)(p.Z,{id:"tooltip-error",children:e.name}),children:(0,C.jsx)("span",{style:{marginLeft:".5rem"},className:Z.file_name,children:e.name})},"sw_".concat(t))]})}),(0,C.jsx)(u.Z,{sm:5,children:"documents"===F&&(0,C.jsx)("form",{ref:E,children:(0,C.jsx)(_.Z,{selectedValue:qe||""})})}),(0,C.jsx)(u.Z,{sm:1,children:(0,C.jsx)(h.$vK,{onClick:function(){return function(e){var t=Object.assign([],Y);t.splice(e,1),$(t)}(t)},size:25,style:{marginRight:".5rem",color:"red",cursor:"pointer"}})})]})},"file_".concat(t))}))}),(0,C.jsxs)(u.Z,{md:12,sm:12,children:[(0,C.jsxs)("form",{id:"form-file-upload",onDragEnter:ze,onSubmit:function(e){return e.preventDefault()},children:["profile"!==F&&(0,C.jsx)("input",{ref:J,type:"file",id:"input-file-upload",accept:"image/png, image/jpeg, application/pdf, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, .zip",multiple:"documents"!==F&&"documentNotSummary_request"!==F,onChange:Te}),"profile"===F&&!de&&(0,C.jsx)("input",{onChange:Te,ref:Re,type:"file",name:"user_image",id:"input-file-upload",accept:"image/png, image/jpeg"}),de&&(0,C.jsx)("div",{className:"temp_image",children:(0,C.jsx)("img",{src:de,alt:""})}),!de&&(0,C.jsx)("label",{id:"label-file-upload",className:W?"drag-active":"",children:(0,C.jsxs)("div",{children:[(0,C.jsx)(b.jY1,{size:60,color:"#5070e1",onClick:Ae,cursor:"pointer"}),(0,C.jsxs)("p",{style:{fontSize:"1.5rem",color:"#99a2b0",margin:0},children:["Drop Files here or ",(0,C.jsx)("span",{onClick:Ae,style:{color:"#5070e1",fontWeight:"bold",fontSize:"2.2rem",cursor:"pointer"},children:"Click here"})]}),(0,C.jsx)("p",{style:{color:"#b0b8c3"},children:"*Please note that png, jpeg, pdf files are allowed"})]})}),W&&(0,C.jsx)("div",{id:"drag-file-element",onDragEnter:ze,onDragLeave:ze,onDragOver:ze,onDrop:function(e){e.preventDefault(),e.stopPropagation(),G(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&Fe(e.dataTransfer.files)}})]}),(0,C.jsx)("span",{className:Z.form_error,children:(0,C.jsx)("small",{children:ie.fileLengthSingle?"File is required":""})}),(0,C.jsx)("span",{className:Z.form_error,children:(0,C.jsx)("small",{children:be?"Matrix File is required":""})})]})]})})}),(0,C.jsxs)(o.Z.Footer,{style:{padding:"1rem 4rem 2rem"},className:"sent_bulk_request",children:[ee&&(0,C.jsx)(b._5g,{size:20,className:"spinner ".concat(Z.details_warning)}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",disabled:ee,onClick:De,style:{width:"100%"},children:"Upload"})}),("myDocument"===F||"receiveDocumentRequest"===F)&&Y.length>1&&(0,C.jsxs)(u.Z,{sm:12,className:"no_padding",children:[(0,C.jsx)("br",{}),(0,C.jsxs)("p",{children:["Please download the ",(0,C.jsx)("b",{children:"Matrix file"})," and update the columns to help system establish connection between the files being uploaded and system."]}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",onClick:function(){return ke("matrix",z)},style:{width:"100%"},children:"Download Sample File"})})]}),"documentNotSummary_request"===F&&(0,C.jsxs)(u.Z,{sm:12,className:"no_padding",children:[(0,C.jsx)("br",{}),(0,C.jsxs)("p",{children:["Please download the ",(0,C.jsx)("b",{children:"Matrix file"})," and update the columns to help system establish connection between the files being uploaded and system."]}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",onClick:function(){return ke("matrix",ge)},style:{width:"100%"},children:"Download Sample File"})})]}),"sentDocumentRequest"===F&&(0,C.jsxs)(u.Z,{sm:12,className:"no_padding",children:[(0,C.jsx)("br",{}),(0,C.jsx)("p",{children:"Please download the sample file to get idea about the fields you need to pass to raise bulk document request"}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",onClick:function(){var e="";e="myDocument"===F?"./sample_file_upload.xlsx":"".concat("http://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/download"),N.rF.get(e,{responseType:"arraybuffer"}).then((function(e){var t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,j.saveAs)(t,"SendRequestDocumentSample.xlsx")}))},style:{width:"100%"},children:"Download Sample File"})})]})]})]})}}}]);
//# sourceMappingURL=192.d180715b.chunk.js.map