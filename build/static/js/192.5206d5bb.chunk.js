"use strict";(self.webpackChunkequabli_front_end=self.webpackChunkequabli_front_end||[]).push([[192],{8192:function(e,t,n){n.d(t,{Z:function(){return F}});var a=n(2982),i=n(4165),l=n(5861),s=n(885),r=n(2791),o=n(129),c=n(7022),u=n(2677),d=n(2105),p=n(2576),m=n(3360),f=n(9126),b=n(5880),h=n(6856),x=n(978),y=n(6053),g=n(6030),v=n(2092),j=n(4802),Z=n(2858),q=n.n(Z),N=n(1679),w=n(8803),k=n(7665),S=function(e){var t=(0,r.useState)(null),a=(0,s.Z)(t,2),o=a[0],c=a[1],u=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){var a,l,s,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,1===t.length)c({zipFile:a,file:t[0]});else{for(l=n(5587)(),s=null,r=0;r<t.length;r++)"matrix.xlsx"===t[r].name&&(s=t[r]),"application/zip"!==t[r].type&&"application/x-zip-compressed"!==t[r].type||(a=t[r]),a||"matrix.xlsx"===t[r].name||l.file(t[r].name,t[r]);a?c({matrixFile:s,file:a}):l.generateAsync({type:"blob"}).then((function(e){return new File([e],"new.zip",{type:"application/x-zip-compressed"})})).then((function(e){c({matrixFile:s,file:e})}))}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return[o,{zipTargetFiles:u}]},_=n(6196),D=n(2453),C=n(184),z=[{sheet:"Matrix",columns:[{label:"Document Type"},{label:"Product Code"},{label:"Original Account Number"},{label:"Client Account Number"},{label:"Document Generation Date"},{label:"Equabli Account Number"},{label:"Client Short Code"},{label:"File Name"}],content:[]}],F=function(e){var t=e.show,n=e.onHide,Z=(e.accountId,e.Styles),F=e.parentComponent,T=e.search,A=e.details,R=void 0===A?null:A,U=(0,v.e1)().addToast,O=(0,g.I0)(),P=(0,r.useRef)(),I=S(null),E=(0,s.Z)(I,2),L=E[0],J=E[1].zipTargetFiles,M=r.useState(!1),B=(0,s.Z)(M,2),H=B[0],V=B[1],W=r.useRef(null),G=(0,r.useState)([]),K=(0,s.Z)(G,2),Y=K[0],$=K[1],Q=(0,r.useState)(!1),X=(0,s.Z)(Q,2),ee=X[0],te=X[1],ne=(0,r.useState)({fileLengthSingle:!1,fileSize:!1}),ae=(0,s.Z)(ne,2),ie=ae[0],le=ae[1],se=(0,r.useState)(""),re=(0,s.Z)(se,2),oe=(re[0],re[1]),ce=(0,r.useState)(),ue=(0,s.Z)(ce,2),de=ue[0],pe=ue[1],me=(0,r.useState)(!1),fe=(0,s.Z)(me,2),be=fe[0],he=fe[1],xe=(0,r.useState)([]),ye=(0,s.Z)(xe,2),ge=ye[0],ve=ye[1],je=(0,r.useState)(null),Ze=(0,s.Z)(je,2),qe=Ze[0],Ne=Ze[1],we=(0,g.v9)((function(e){return{documentTypes:e.types.documentType.data}})).documentTypes;(0,r.useEffect)((function(){var e=D.W4.getUserType();oe(e),"documentNotSummary_request"===F&&Se()}),[]),(0,r.useEffect)((function(){L&&"{}"!==JSON.stringify(L)&&Ce()}),[L]);var ke=function(e,t){var n={fileName:e};q()(t,n)},Se=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,n,a,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(R),e.prev=1,e.next=4,w.rF.post("".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("document-service/api","/user/document/summary/accounts/not"),{pageSize:R.pageSize,pageNumber:R.pageNumber-1,docTypeCode:R.docTypeCode,tenure:"null"===R.duration?null:R.duration,portfolio:"null"===R.portfolio?null:R.portfolio,productCode:"null"===R.productCode?null:R.productCode,userId:"null"===R.userId?null:R.userId});case 4:t=e.sent,n=(0,w._y)(t),a=[{sheet:"Matrix",columns:[{label:"Document Type",value:"documentType"},{label:"Requested From",value:"requestedFrom"},{label:"Original Account Number",value:"originalAccountNumber"},{label:"Client Account Number",value:"clientAccountNumber"},{label:"Equabli Account Number",value:"equabliAccountNumber"},{label:"Client Short Code",value:"clientShortCode"}],content:[]}],l=n&&n.response&&n.response.datas.map((function(e){return{documentType:R.docTypeCode,requestedFrom:"",originalAccountNumber:"",clientAccountNumber:e,equabliAccountNumber:"",clientShortCode:""}})),a[0].content=l,ve(a),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),_e=function(e){var t=!0,n={file:!1};for(var a in 0===e.file&&(n.fileLengthSingle=!0),e)e[a]&&""!==e[a]||(n[a]=!0);for(var i in n)n[i]&&(t=!1);return le(n),t},De=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),_e({file:Y.length})&&(te(!0),J(Y));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,a,l,s,r,o,c,u,d,p,m;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(he(!1),t={headers:{"Content-Type":"multipart/form-data"}},a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload"),l=L.file,s=L.matrixFile,"myDocument"!==F&&"receiveDocumentRequest"!==F||!(Y.length>1)||s){e.next=8;break}return te(!1),he(!0),e.abrupt("return");case 8:if(r=new FormData,e.prev=9,!(l.size>10485760)){e.next=14;break}return U((0,N.t)("info","FILE_LARGE",""),{appearance:"info",autoDismiss:!0}),te(!1),e.abrupt("return");case 14:if("application/zip"!==l.type&&"application/x-zip-compressed"!==l.type){e.next=32;break}return r.append("files",l),r.append("files",s),r.append("fileUploadVan",JSON.stringify({bulkType:"upload"})),a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/bulk"),e.next=21,w.rF.post(a,r,t);case 21:return o=e.sent,c=(0,w._y)(o),e.next=25,w.rF.post("".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/bulk/read"),{orgType:"CT",excelUrl:c.response.fileUrl[1],zipUrl:c.response.fileUrl[0],bulkType:"upload"});case 25:u=e.sent,(0,w._y)(u),U((0,N.t)("success","uploaded","File"),{appearance:"success",autoDismiss:!0}),te(!1),n(),e.next=40;break;case 32:return"profile"===F?(a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("user-service/api","/v1/users/uploadProfilePic"),r.append("file",l)):"documents"===F?(d=P.current.document_type,a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/account"),r.append("data",JSON.stringify({accountNumber:R.accountId,docType:d.value})),r.append("file",l)):"receiveDocumentRequest"===F&&null!==R?(a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/fullfill"),r.append("file",l),r.append("id",JSON.stringify(R.id))):"sentDocumentRequest"===F||"documentNotSummary_request"===F?(a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/bulk"),r.append("files",l),r.append("fileUploadVan",JSON.stringify({bulkType:"SendRequestDocument"}))):"documentNotSummary"===F?(a="".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/upload/specific/accounts"),p={docTypeCode:R.docTypeCode},r.append("file",l),r.append("data",JSON.stringify(p))):r.append("file",l),e.next=35,w.rF.post(a,r,t);case 35:m=e.sent,(0,w._y)(m),U((0,N.t)("success","uploaded","File"),{appearance:"success",autoDismiss:!0}),te(!1),n();case 40:O(k.N.getSentSummary({})),T(),e.next=49;break;case 44:throw e.prev=44,e.t0=e.catch(9),te(!1),U((0,N.t)("error","uploading","file"),{appearance:"error",autoDismiss:!1}),e.t0;case 49:case"end":return e.stop()}}),e,null,[[9,44]])})));return function(){return e.apply(this,arguments)}}(),ze=function(e){e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?V(!0):"dragleave"===e.type&&V(!1)},Fe=function(e){var t=Object.assign([],Y);if("profile"===F){var n=new FileReader;n.readAsDataURL(e[0]);n.onloadend=function(e){pe(n.result)}}if("documents"!==F)t=0===t.length?Array.from(e):[].concat((0,a.Z)(t),(0,a.Z)(Array.from(e)));else{var i=we.map((function(e){return e.shortCode})),l=Array.from(e);i.map((function(e){l[0].name.includes("_".concat(e,"_"))&&Ne(e)})),t=Array.from(e)}$(t)},Te=function(e){e.preventDefault(),e.target.files&&e.target.files[0]&&Fe(e.target.files)},Ae=function(){"profile"!==F?W.current.click():Re.current.click()},Re=(0,r.useRef)();return(0,C.jsxs)(o.Z,{show:t,onHide:n,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,size:"lg",animation:!0,children:[(0,C.jsx)(o.Z.Header,{closeButton:!0,children:(0,C.jsxs)(o.Z.Title,{id:"contained-modal-title-vcenter",children:["myDocument"===F||"documents"===F||"documentNotSummary"===F||"documentNotSummary_request"===F?"Upload New Document":"sentDocumentRequest"===F?"Upload file for bulk document request":"","profile"===F&&"Upload Profile Picture","receiveDocumentRequest"===F&&"Upload File to FulFill the request"]})}),(0,C.jsx)(o.Z.Body,{className:"show-grid",children:(0,C.jsx)(c.Z,{children:(0,C.jsxs)(u.Z,{sm:12,children:["profile"!==F&&(0,C.jsx)("div",{className:Z.list_upload_container,children:Y&&Y.length>0&&Y.map((function(e,t){return(0,C.jsx)("div",{className:Z.list_upload,children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,C.jsx)(u.Z,{sm:6,children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["application/x-zip-compressed"===e.type&&(0,C.jsx)(y.nzh,{}),"application/pdf"===e.type&&(0,C.jsx)(f.DWq,{}),("image/png"===e.type||"image/jpeg"===e.type)&&(0,C.jsx)(f.tf6,{}),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type&&(0,C.jsx)(x.bBH,{}),(0,C.jsx)(d.Z,{placement:"bottom",delay:{show:250,hide:400},overlay:(0,C.jsx)(p.Z,{id:"tooltip-error",children:e.name}),children:(0,C.jsx)("span",{style:{marginLeft:".5rem"},className:Z.file_name,children:e.name})},"sw_".concat(t))]})}),(0,C.jsx)(u.Z,{sm:5,children:"documents"===F&&(0,C.jsx)("form",{ref:P,children:(0,C.jsx)(_.Z,{selectedValue:qe||""})})}),(0,C.jsx)(u.Z,{sm:1,children:(0,C.jsx)(h.$vK,{onClick:function(){return function(e){var t=Object.assign([],Y);t.splice(e,1),$(t)}(t)},size:25,style:{marginRight:".5rem",color:"red",cursor:"pointer"}})})]})},"file_".concat(t))}))}),(0,C.jsxs)(u.Z,{md:12,sm:12,children:[(0,C.jsxs)("form",{id:"form-file-upload",onDragEnter:ze,onSubmit:function(e){return e.preventDefault()},children:["profile"!==F&&(0,C.jsx)("input",{ref:W,type:"file",id:"input-file-upload",accept:"image/png, image/jpeg, application/pdf, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, .zip",multiple:"documents"!==F&&"documentNotSummary_request"!==F,onChange:Te}),"profile"===F&&!de&&(0,C.jsx)("input",{onChange:Te,ref:Re,type:"file",name:"user_image",id:"input-file-upload",accept:"image/png, image/jpeg"}),de&&(0,C.jsx)("div",{className:"temp_image",children:(0,C.jsx)("img",{src:de,alt:""})}),!de&&(0,C.jsx)("label",{id:"label-file-upload",className:H?"drag-active":"",children:(0,C.jsxs)("div",{children:[(0,C.jsx)(b.jY1,{size:60,color:"#5070e1",onClick:Ae,cursor:"pointer"}),(0,C.jsxs)("p",{style:{fontSize:"1.5rem",color:"#99a2b0",margin:0},children:["Drop Files here or ",(0,C.jsx)("span",{onClick:Ae,style:{color:"#5070e1",fontWeight:"bold",fontSize:"2.2rem",cursor:"pointer"},children:"Click here"})]}),(0,C.jsx)("p",{style:{color:"#b0b8c3"},children:"*Please note that png, jpeg, pdf files are allowed"})]})}),H&&(0,C.jsx)("div",{id:"drag-file-element",onDragEnter:ze,onDragLeave:ze,onDragOver:ze,onDrop:function(e){e.preventDefault(),e.stopPropagation(),V(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&Fe(e.dataTransfer.files)}})]}),(0,C.jsx)("span",{className:Z.form_error,children:(0,C.jsx)("small",{children:ie.fileLengthSingle?"File is required":""})}),(0,C.jsx)("span",{className:Z.form_error,children:(0,C.jsx)("small",{children:be?"Matrix File is required":""})})]})]})})}),(0,C.jsxs)(o.Z.Footer,{style:{padding:"1rem 4rem 2rem"},className:"sent_bulk_request",children:[ee&&(0,C.jsx)(b._5g,{size:20,className:"spinner ".concat(Z.details_warning)}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",disabled:ee,onClick:De,style:{width:"100%"},children:"Upload"})}),("myDocument"===F||"receiveDocumentRequest"===F)&&Y.length>1&&(0,C.jsxs)(u.Z,{sm:12,className:"no_padding",children:[(0,C.jsx)("br",{}),(0,C.jsxs)("p",{children:["Please download the ",(0,C.jsx)("b",{children:"Matrix file"})," and update the columns to help system establish connection between the files being uploaded and system."]}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",onClick:function(){return ke("matrix",z)},style:{width:"100%"},children:"Download Sample File"})})]}),"documentNotSummary_request"===F&&(0,C.jsxs)(u.Z,{sm:12,className:"no_padding",children:[(0,C.jsx)("br",{}),(0,C.jsxs)("p",{children:["Please download the ",(0,C.jsx)("b",{children:"Matrix file"})," and update the columns to help system establish connection between the files being uploaded and system."]}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",onClick:function(){return ke("matrix",ge)},style:{width:"100%"},children:"Download Sample File"})})]}),"sentDocumentRequest"===F&&(0,C.jsxs)(u.Z,{sm:12,className:"no_padding",children:[(0,C.jsx)("br",{}),(0,C.jsx)("p",{children:"Please download the sample file to get idea about the fields you need to pass to raise bulk document request"}),(0,C.jsx)(u.Z,{sm:12,className:"no_padding",children:(0,C.jsx)(m.Z,{variant:"dark",type:"submit",onClick:function(){var e="";e="myDocument"===F?"./sample_file_upload.xlsx":"".concat("https://k8s-equablid-equablii-3d7f80b23b-1277713601.us-east-1.elb.amazonaws.com","/").concat("file-action-service/api","/file/download"),w.rF.get(e,{responseType:"arraybuffer"}).then((function(e){var t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,j.saveAs)(t,"SendRequestDocumentSample.xlsx")}))},style:{width:"100%"},children:"Download Sample File"})})]})]})]})}}}]);
//# sourceMappingURL=192.5206d5bb.chunk.js.map